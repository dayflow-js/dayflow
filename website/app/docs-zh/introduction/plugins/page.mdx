# **æ’ä»¶ç³»ç»Ÿ**

Day Flow é‡‡ç”¨æ’ä»¶æ¶æ„æ¥æ‰©å±•åŠŸèƒ½ã€‚æ’ä»¶æä¾›æ¨¡å—åŒ–ç‰¹æ€§ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦å¯ç”¨ã€ç¦ç”¨æˆ–é…ç½®è¿™äº›åŠŸèƒ½ã€‚

## **æ’ä»¶ç³»ç»Ÿæ¦‚è§ˆ**

æ’ä»¶ç³»ç»Ÿå…è®¸æ‚¨ï¼š

- **å¯ç”¨/ç¦ç”¨åŠŸèƒ½**Â - æŒ‰éœ€åŠ è½½æ‰€éœ€åŠŸèƒ½
- **é…ç½®è¡Œä¸º**Â - è‡ªå®šä¹‰æ’ä»¶è®¾ç½®
- **æ‰©å±•åŠŸèƒ½**Â - åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶
- **è®¿é—®æ’ä»¶ API**Â - åœ¨ä»£ç ä¸­ä½¿ç”¨æ’ä»¶æœåŠ¡

## **å†…ç½®æ’ä»¶**

Day Flow æä¾›ä¸¤ä¸ªæ ¸å¿ƒæ’ä»¶ï¼š

### **æ‹–æ‹½æ’ä»¶**

æ”¯æŒé€šè¿‡æ‹–æ‹½åˆ›å»ºã€ç§»åŠ¨å’Œè°ƒæ•´äº‹ä»¶æ—¶é•¿ã€‚

**åŠŸèƒ½ç‰¹æ€§ï¼š**

- æ‹–æ‹½ç§»åŠ¨äº‹ä»¶
- è°ƒæ•´å¤§å°æ”¹å˜äº‹ä»¶æ—¶é•¿
- åŒå‡»åˆ›å»ºæ–°äº‹ä»¶
- åœ¨å…¨å¤©åŒºåŸŸæ‹–æ‹½åˆ›å»ºå…¨å¤©äº‹ä»¶
- è§†å›¾ç‰¹å®šè¡Œä¸º

**å®‰è£…æ–¹å¼ï¼š**

```tsx
import {
  useCalendarApp,
  DayFlowCalendar,
  createDragPlugin,
  createMonthView,
  ViewType,
} from '@dayflow/core';
import '@dayflow/core/dist/styles.css';

function MyCalendar() {
  const dragPlugin = createDragPlugin({
    enableDrag: true,
    enableResize: true,
    enableCreate: true,
    enableAllDayCreate: true,
    supportedViews: [ViewType.DAY, ViewType.WEEK, ViewType.MONTH],
  });

  const calendar = useCalendarApp({
    views: [createMonthView()],
    plugins: [dragPlugin],
  });

  return <DayFlowCalendar calendar={calendar} />;
}
```

**é…ç½®é€‰é¡¹ï¼š**

```tsx
interface DragPluginConfig {
  enableDrag: boolean;// å¯ç”¨äº‹ä»¶æ‹–æ‹½ï¼ˆé»˜è®¤ï¼štrueï¼‰
  enableResize: boolean;// å¯ç”¨è°ƒæ•´äº‹ä»¶å¤§å°ï¼ˆé»˜è®¤ï¼štrueï¼‰
  enableCreate: boolean;// å¯ç”¨åŒå‡»åˆ›å»ºäº‹ä»¶ï¼ˆé»˜è®¤ï¼štrueï¼‰
  enableAllDayCreate: boolean;// å¯ç”¨åˆ›å»ºå…¨å¤©äº‹ä»¶ï¼ˆé»˜è®¤ï¼štrueï¼‰
  supportedViews: ViewType[];// æ”¯æŒæ‹–æ‹½çš„è§†å›¾ï¼ˆé»˜è®¤ï¼š[DAY, WEEK, MONTH]ï¼‰}
```

**é»˜è®¤é…ç½®ï¼š**

```tsx
const dragPlugin = createDragPlugin({
  enableDrag: true,
  enableResize: true,
  enableCreate: true,
  enableAllDayCreate: true,
  supportedViews: [ViewType.DAY, ViewType.WEEK, ViewType.MONTH],
});
```

**è®¿é—®æ‹–æ‹½ APIï¼š**

```tsx
// ä»æ—¥å†åº”ç”¨è·å–æ‹–æ‹½æœåŠ¡
const dragService = calendar.app.getPlugin<DragService>('drag');

// è·å–å½“å‰é…ç½®
const config = dragService?.getConfig();

// åŠ¨æ€æ›´æ–°é…ç½®
dragService?.updateConfig({
  enableResize: false,
});

// æ£€æŸ¥è§†å›¾æ˜¯å¦æ”¯æŒæ‹–æ‹½
const isSupported = dragService?.isViewSupported(ViewType.MONTH);
```

### **äº‹ä»¶æ’ä»¶**

æä¾›é«˜çº§äº‹ä»¶ç®¡ç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬éªŒè¯ã€ç­›é€‰å’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚

**åŠŸèƒ½ç‰¹æ€§ï¼š**

- äº‹ä»¶éªŒè¯
- æ—¥æœŸèŒƒå›´æŸ¥è¯¢
- äº‹ä»¶ç­›é€‰
- è‡ªåŠ¨æ—¥æœŸé‡è®¡ç®—
- æ¯æ—¥äº‹ä»¶æ•°é‡é™åˆ¶

**å®‰è£…æ–¹å¼ï¼š**

```tsx
import {
  useCalendarApp,
  DayFlowCalendar,
  createEventsPlugin,
  createMonthView,
} from '@dayflow/core';
import '@dayflow/core/dist/styles.css';

function MyCalendar() {
  const eventsPlugin = createEventsPlugin({
    enableAutoRecalculate: true,
    enableValidation: true,
    maxEventsPerDay: 50,
  });

  const calendar = useCalendarApp({
    views: [createMonthView()],
    plugins: [eventsPlugin],
  });

  return <DayFlowCalendar calendar={calendar} />;
}
```

**é…ç½®é€‰é¡¹ï¼š**

```tsx
interface EventsPluginConfig {
  enableAutoRecalculate?: boolean; // è‡ªåŠ¨é‡è®¡ç®—äº‹ä»¶æ—¥æœŸï¼ˆé»˜è®¤ï¼štrueï¼‰
  enableValidation?: boolean; // æ·»åŠ /æ›´æ–°å‰éªŒè¯äº‹ä»¶ï¼ˆé»˜è®¤ï¼štrueï¼‰
  defaultEvents?: Event[]; // åˆå§‹äº‹ä»¶ï¼ˆé»˜è®¤ï¼š[]ï¼‰
  maxEventsPerDay?: number; // æ¯æ—¥æœ€å¤§äº‹ä»¶æ•°ï¼ˆé»˜è®¤ï¼š50ï¼‰
}
```

**è®¿é—®äº‹ä»¶ APIï¼š**

```tsx
// ä»æ—¥å†åº”ç”¨è·å–äº‹ä»¶æœåŠ¡
const eventsService = calendar.app.getPlugin<EventsService>('events');

// è·å–æ‰€æœ‰äº‹ä»¶
const allEvents = eventsService?.getAll();

// æ ¹æ® ID è·å–äº‹ä»¶
const event = eventsService?.getById('event-1');

// æ ¹æ®æ—¥æœŸè·å–äº‹ä»¶
const todayEvents = eventsService?.getByDate(new Date());

// æ ¹æ®æ—¥æœŸèŒƒå›´è·å–äº‹ä»¶
const rangeEvents = eventsService?.getByDateRange(
  new Date(2024, 9, 1),
  new Date(2024, 9, 31)
);

// è·å–ç‰¹å®šæ˜ŸæœŸå‡ çš„äº‹ä»¶
const mondayEvents = eventsService?.getByDay(0, weekStart);

// è·å–å…¨å¤©äº‹ä»¶
const allDayEvents = eventsService?.getAllDayEvents(0, events);

// éªŒè¯äº‹ä»¶
const errors = eventsService?.validateEvent(event);
if (errors && errors.length > 0) {
  console.error('éªŒè¯é”™è¯¯:', errors);
}

// æ ¹æ®æ—¥å†ç±»å‹ç­›é€‰äº‹ä»¶
const filteredEvents = eventsService?.filterEvents(
  events,
  event => event.calendarId === 'work'
);

// é‡è®¡ç®—äº‹ä»¶æ—¥æœŸ
const recalculatedEvents = eventsService?.recalculateEventDays(
  events,
  weekStart
);
```

## **ä½¿ç”¨å¤šä¸ªæ’ä»¶**

æ‚¨å¯ä»¥ç»„åˆå¤šä¸ªæ’ä»¶ä»¥è·å¾—å®Œæ•´åŠŸèƒ½ï¼š

```tsx
import {
  useCalendarApp,
  DayFlowCalendar,
  createDragPlugin,
  createEventsPlugin,
  createMonthView,
  createWeekView,
} from '@dayflow/core';
import '@dayflow/core/dist/styles.css';

function MyCalendar() {
  const dragPlugin = createDragPlugin({
    enableDrag: true,
    enableResize: true,
    enableCreate: true,
  });

  const eventsPlugin = createEventsPlugin({
    enableValidation: true,
    maxEventsPerDay: 50,
  });

  const calendar = useCalendarApp({
    views: [createMonthView(), createWeekView()],
    plugins: [dragPlugin, eventsPlugin],
    events: initialEvents,
  });

  return <DayFlowCalendar calendar={calendar} />;
}
```

## **åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªæ’ä»¶**

åœ¨å¤§å¤šæ•°ä½¿ç”¨åœºæ™¯ä¸­ï¼Œæ‚¨ä¼šå¸Œæœ›åŒæ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªæ’ä»¶ï¼š

```tsx
import {
  useCalendarApp,
  DayFlowCalendar,
  createDragPlugin,
  createEventsPlugin,
  createMonthView,
} from '@dayflow/core';
import '@dayflow/core/dist/styles.css';

function MyCalendar() {
  const dragPlugin = createDragPlugin({
    enableDrag: true,
    enableResize: true,
  });

  const eventsPlugin = createEventsPlugin({
    enableValidation: true,
    maxEventsPerDay: 100,
  });

  const calendar = useCalendarApp({
    views: [createMonthView()],
    plugins: [dragPlugin, eventsPlugin],
  });

  return <DayFlowCalendar calendar={calendar} />;
}
```

## **åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶**

æ‚¨å¯ä»¥åˆ›å»ºè‡ªå·±çš„æ’ä»¶æ¥æ‰©å±•æ—¥å†åŠŸèƒ½ï¼š

### **æ’ä»¶æ¥å£**

```tsx
interface CalendarPlugin {
  name: string;// å”¯ä¸€æ’ä»¶åç§°install: (app: CalendarApp) => void;// å®‰è£…å‡½æ•°
  config?: Record<string, unknown>;// æ’ä»¶é…ç½®
  api?: unknown;// å…¬å…± API}
```

### **ç¤ºä¾‹ï¼šæ•°æ®åˆ†ææ’ä»¶**

```tsx
import { CalendarPlugin, CalendarApp, Event } from '@dayflow/core';

interface AnalyticsConfig {
  trackEventCreate: boolean;
  trackEventUpdate: boolean;
  trackEventDelete: boolean;
  trackViewChange: boolean;
}

interface AnalyticsService {
  logEvent: (name: string, data: any) => void;
  getStats: () => { eventCreates: number; eventUpdates: number };
}

export function createAnalyticsPlugin(
  config: Partial<AnalyticsConfig> = {}
): CalendarPlugin {
  const finalConfig: AnalyticsConfig = {
    trackEventCreate: true,
    trackEventUpdate: true,
    trackEventDelete: true,
    trackViewChange: true,
    ...config,
  };

  let stats = {
    eventCreates: 0,
    eventUpdates: 0,
    eventDeletes: 0,
    viewChanges: 0,
  };

  const analyticsService: AnalyticsService = {
    logEvent: (name: string, data: any) => {
      console.log(`[æ•°æ®åˆ†æ] ${name}:`, data);
      // å‘é€åˆ°æ‚¨çš„æ•°æ®åˆ†ææœåŠ¡
    },
    getStats: () => ({
      eventCreates: stats.eventCreates,
      eventUpdates: stats.eventUpdates,
    }),
  };

  return {
    name: 'analytics',
    config: finalConfig,
    install: (app: CalendarApp) => {
      console.log('ğŸ“Š æ•°æ®åˆ†ææ’ä»¶å·²å®‰è£…');

      // æŒ‚è½½åˆ°æ—¥å†å›è°ƒå‡½æ•°
      const originalAddEvent = app.addEvent.bind(app);
      app.addEvent = (event: Event) => {
        if (finalConfig.trackEventCreate) {
          stats.eventCreates++;
          analyticsService.logEvent('event_created', { id: event.id });
        }
        originalAddEvent(event);
      };

      const originalUpdateEvent = app.updateEvent.bind(app);
      app.updateEvent = (id: string, updates: Partial<Event>) => {
        if (finalConfig.trackEventUpdate) {
          stats.eventUpdates++;
          analyticsService.logEvent('event_updated', { id });
        }
        originalUpdateEvent(id, updates);
      };

      const originalDeleteEvent = app.deleteEvent.bind(app);
      app.deleteEvent = (id: string) => {
        if (finalConfig.trackEventDelete) {
          stats.eventDeletes++;
          analyticsService.logEvent('event_deleted', { id });
        }
        originalDeleteEvent(id);
      };
    },
    api: analyticsService,
  };
}
```

### **ä½¿ç”¨è‡ªå®šä¹‰æ’ä»¶**

```tsx
import {
  useCalendarApp,
  DayFlowCalendar,
  createMonthView,
} from '@dayflow/core';

function MyCalendar() {
  const analyticsPlugin = createAnalyticsPlugin({
    trackEventCreate: true,
    trackEventUpdate: true,
  });

  const calendar = useCalendarApp({
    views: [createMonthView()],
    plugins: [analyticsPlugin],
  });

  // è®¿é—®æ’ä»¶ APIconst analytics = calendar.app.getPlugin<AnalyticsService>('analytics');
  const stats = analytics?.getStats();

  return <DayFlowCalendar calendar={calendar} />;
}
```

## **æ’ä»¶æœ€ä½³å®è·µ**

### **1. å‘½åè§„èŒƒ**

ä¸ºæ’ä»¶ä½¿ç”¨æè¿°æ€§ä¸”å”¯ä¸€çš„åç§°ï¼š

```tsx
// æ¨è
name: 'analytics';
name: 'custom-validation';
name: 'sync';

// ä¸æ¨è
name: 'plugin';
name: 'p1';
```

### **2. é…ç½®è®¾è®¡**

æä¾›åˆç†çš„é»˜è®¤å€¼ï¼Œå¹¶ä½¿é…ç½®å¯é€‰ï¼š

```tsx
const defaultConfig = {
  enabled: true,
  timeout: 5000,
};

export function createMyPlugin(config: Partial<MyConfig> = {}) {
  const finalConfig = { ...defaultConfig, ...config };
  // ...
}
```

### **3. API è®¾è®¡**

ä¸ºæ’ä»¶åŠŸèƒ½æä¾›æ¸…æ™°ã€ç±»å‹åŒ–çš„ APIï¼š

```tsx
interface MyPluginService {
  doSomething: () => void;
  getSomething: () => SomeData;
}

const service: MyPluginService = {
  doSomething: () => {
    /* ... */
  },
  getSomething: () => {
    /* ... */
  },
};

return {
  name: 'my-plugin',
  api: service,
};
```

## **æ’ä»¶ç”Ÿå‘½å‘¨æœŸ**

1. **æ’ä»¶åˆ›å»º**Â - ä½¿ç”¨é…ç½®è°ƒç”¨Â `createMyPlugin()`
2. **æ’ä»¶æ³¨å†Œ**Â - æ·»åŠ åˆ°Â `useCalendarApp`Â çš„Â `plugins`Â æ•°ç»„ä¸­
3. **å®‰è£…**Â - ä½¿ç”¨ CalendarApp å®ä¾‹è°ƒç”¨Â `install()`Â å‡½æ•°
4. **ä½¿ç”¨**Â - é€šè¿‡Â `app.getPlugin()`Â è®¿é—®æ’ä»¶ API

```tsx
// 1. åˆ›å»º
const plugin = createDragPlugin({ enableDrag: true });

// 2. æ³¨å†Œ
const calendar = useCalendarApp({
  plugins: [plugin], // åœ¨æ­¤å¤„è¿›è¡Œå®‰è£…
});

// 3. ä½¿ç”¨
const dragService = calendar.app.getPlugin<DragService>('drag');
```

## **æ£€æŸ¥æ’ä»¶æ˜¯å¦å­˜åœ¨**

åœ¨ä½¿ç”¨æ’ä»¶å‰å§‹ç»ˆæ£€æŸ¥æ’ä»¶æ˜¯å¦å·²å®‰è£…ï¼š

```tsx
function MyComponent({ calendar }: { calendar: CalendarApp }) {
  // æ£€æŸ¥æ’ä»¶æ˜¯å¦å­˜åœ¨
  if (calendar.hasPlugin('drag')) {
    const dragService = calendar.getPlugin<DragService>('drag');
    // ä½¿ç”¨æ‹–æ‹½æœåŠ¡
  }

  // æˆ–è€…è·å–å¹¶æ£€æŸ¥
  const eventsService = calendar.getPlugin<EventsService>('events');
  if (eventsService) {
    const events = eventsService.getAll();
  }
}
```

## **æ’ä»¶ TypeScript ç±»å‹**

```tsx
import type {
  CalendarPlugin,
  DragService,
  DragPluginConfig,
  EventsService,
  EventsPluginConfig,
} from '@dayflow/core';

// ç±»å‹å®‰å…¨çš„æ’ä»¶ä½¿ç”¨const dragService = app.getPlugin<DragService>('drag');
const eventsService = app.getPlugin<EventsService>('events');
```

## **ç›¸å…³æ–‡æ¡£**

- [å¿«é€Ÿå¼€å§‹](docs/getting-started)Â - åŸºç¡€è®¾ç½®
- [äº‹ä»¶ç®¡ç†](docs/events)Â - å¤„ç†æ—¥å†äº‹ä»¶
- [è§†å›¾ç®¡ç†](docs/views)Â - ç†è§£æ—¥å†è§†å›¾
- [API å‚è€ƒ](docs/api-reference)Â - å®Œæ•´çš„ API æ–‡æ¡£
